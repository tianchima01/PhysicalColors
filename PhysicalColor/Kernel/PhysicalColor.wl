(* ::Package:: *)

BeginPackage["PhysicalColor`"]


SpectrumExcitation::usage="SpectrumExcitation[wvl] returns the linear XYZ excitation of light at wavelength wvl."
SpectrumColor::usage="SpectrumColor[wvl] returns XYZColor of light at wavelength wvl."
TemperatureColor::usage="TemperatureColor[temp] returns RGBColor of a blackbody at temperature temp.";
TemperatureIntensity::usage="TemperatureIntensity[temp] returns relative light intensity of a blackbody at temperature temp."


Begin["`Private`"]


(* ::Text:: *)
(*Spectrum Excitation @ CIE 1931 (linear, can be converted using XYZ to RGB)*)


$ExcitationRaw={{380.`,0.001368`,0.000039`,0.006450001`},{381.`,0.00150205`,0.0000428264`,0.007083216`},{382.`,0.001642328`,0.0000469146`,0.007745488`},{383.`,0.001802382`,0.0000515896`,0.008501152`},{384.`,0.001995757`,0.0000571764`,0.009414544`},{385.`,0.002236`,0.000064`,0.01054999`},{386.`,0.002535385`,0.0000723442`,0.0119658`},{387.`,0.002892603`,0.0000822122`,0.01365587`},{388.`,0.003300829`,0.0000935082`,0.01558805`},{389.`,0.003753236`,0.000106136`,0.01773015`},{390.`,0.004243`,0.00012`,0.02005001`},{391.`,0.004762389`,0.000134984`,0.02251136`},{392.`,0.005330048`,0.000151492`,0.02520288`},{393.`,0.005978712`,0.000170208`,0.02827972`},{394.`,0.006741117`,0.000191816`,0.03189704`},{395.`,0.00765`,0.000217`,0.03621`},{396.`,0.008751373`,0.000246907`,0.04143771`},{397.`,0.01002888`,0.00028124`,0.04750372`},{398.`,0.0114217`,0.00031852`,0.05411988`},{399.`,0.01286901`,0.000357267`,0.06099803`},{400.`,0.01431`,0.000396`,0.06785001`},{401.`,0.01570443`,0.000433715`,0.07448632`},{402.`,0.01714744`,0.000473024`,0.08136156`},{403.`,0.01878122`,0.000517876`,0.08915364`},{404.`,0.02074801`,0.000572219`,0.09854048`},{405.`,0.02319`,0.00064`,0.1102`},{406.`,0.02620736`,0.00072456`,0.1246133`},{407.`,0.02978248`,0.0008255`,0.1417017`},{408.`,0.03388092`,0.00094116`,0.1613035`},{409.`,0.03846824`,0.00106988`,0.1832568`},{410.`,0.04351`,0.00121`,0.2074`},{411.`,0.0489956`,0.001362091`,0.2336921`},{412.`,0.0550226`,0.001530752`,0.2626114`},{413.`,0.0617188`,0.001720368`,0.2947746`},{414.`,0.069212`,0.001935323`,0.3307985`},{415.`,0.07763`,0.00218`,0.3713`},{416.`,0.08695811`,0.0024548`,0.4162091`},{417.`,0.09717672`,0.002764`,0.4654642`},{418.`,0.1084063`,0.0031178`,0.5196948`},{419.`,0.1207672`,0.0035264`,0.5795303`},{420.`,0.13438`,0.004`,0.6456`},{421.`,0.1493582`,0.00454624`,0.7184838`},{422.`,0.1653957`,0.00515932`,0.7967133`},{423.`,0.1819831`,0.00582928`,0.8778459`},{424.`,0.198611`,0.00654616`,0.959439`},{425.`,0.21477`,0.0073`,1.0390501`},{426.`,0.231868`,0.008086507`,1.1153673`},{427.`,0.2448797`,0.00890872`,1.1884971`},{428.`,0.2587773`,0.00976768`,1.2581231`},{429.`,0.2718079`,0.01066443`,1.3239296`},{430.`,0.2839`,0.0116`,1.3856`},{431.`,0.2949468`,0.01257317`,1.4426352`},{432.`,0.3048965`,0.01358272`,1.4948035`},{433.`,0.3137873`,0.01462968`,1.5421903`},{434.`,0.3216454`,0.01571509`,1.5848807`},{435.`,0.3285`,0.01684`,1.62296`},{436.`,0.3343513`,0.01800736`,1.6564048`},{437.`,0.3392101`,0.01921448`,1.6852959`},{438.`,0.3431213`,0.02045392`,1.7098745`},{439.`,0.3461296`,0.02171824`,1.7303821`},{440.`,0.34828`,0.023`,1.74706`},{441.`,0.3495999`,0.02429461`,1.7600446`},{442.`,0.3501474`,0.02561024`,1.7696233`},{443.`,0.350013`,0.02695857`,1.7762637`},{444.`,0.349287`,0.02835125`,1.7804334`},{445.`,0.34806`,0.0298`,1.7826`},{446.`,0.3463733`,0.03131083`,1.7829682`},{447.`,0.3442624`,0.03288368`,1.7816998`},{448.`,0.3418088`,0.03452112`,1.7791982`},{449.`,0.3390941`,0.03622571`,1.7758671`},{450.`,0.3362`,0.038`,1.77211`},{451.`,0.3331977`,0.03984667`,1.7682589`},{452.`,0.3300411`,0.041768`,1.764039`},{453.`,0.3266357`,0.043766`,1.7589438`},{454.`,0.3228868`,0.04584267`,1.7524663`},{455.`,0.3187`,0.048`,1.7441`},{456.`,0.3140251`,0.05024368`,1.7335595`},{457.`,0.308884`,0.05257304`,1.7208581`},{458.`,0.3032904`,0.05498056`,1.7059369`},{459.`,0.2972579`,0.05745872`,1.6887372`},{460.`,0.2903`,0.06`,1.6692`},{461.`,0.2839701`,0.06260197`,1.6475287`},{462.`,0.2767214`,0.06527752`,1.6234127`},{463.`,0.2689178`,0.06804208`,1.5960223`},{464.`,0.2604227`,0.07091109`,1.564528`},{465.`,0.251`,0.0739`,1.5281`},{466.`,0.2408475`,0.077016`,1.4861114`},{467.`,0.229851`,0.0802664`,1.4395215`},{468.`,0.2184072`,0.0836668`,1.3898799`},{469.`,0.2068115`,0.0872328`,1.3387362`},{470.`,0.19536`,0.09098`,1.28764`},{471.`,0.1842136`,0.09491755`,1.2374223`},{472.`,0.1733273`,0.09904584`,1.1878243`},{473.`,0.1626881`,0.1033674`,1.1387611`},{474.`,0.1522833`,0.108846`,1.090148`},{475.`,0.1421`,0.1126`,1.0419`},{476.`,0.1321786`,0.117532`,0.9941976`},{477.`,0.1225696`,0.1226744`,0.9473473`},{478.`,0.1132752`,0.1279928`,0.9014531`},{479.`,0.1042979`,0.1334528`,0.8566193`},{480.`,0.09564`,0.13902`,0.8129501`},{481.`,0.08729955`,0.1446764`,0.7705173`},{482.`,0.07920804`,0.1504693`,0.7294448`},{483.`,0.07171776`,0.1564619`,0.6899136`},{484.`,0.06458099`,0.1627177`,0.6521049`},{485.`,0.05795001`,0.1693`,0.6162`},{486.`,0.05186211`,0.1762431`,0.5823286`},{487.`,0.04628152`,0.1835581`,0.5504162`},{488.`,0.04115088`,0.1912735`,0.5203376`},{489.`,0.03641283`,0.199418`,0.4919673`},{490.`,0.03201`,0.20802`,0.46518`},{491.`,0.0279172`,0.2171199`,0.4399246`},{492.`,0.0241444`,0.2267345`,0.4161836`},{493.`,0.020687`,0.2368571`,0.3938822`},{494.`,0.0175404`,0.2474812`,0.3729459`},{495.`,0.0147`,0.2586`,0.3533`},{496.`,0.01216179`,0.2701849`,0.3348578`},{497.`,0.00991996`,0.2822939`,0.3175521`},{498.`,0.00796724`,0.2950505`,0.3013375`},{499.`,0.006296346`,0.308578`,0.2861686`},{500.`,0.0049`,0.323`,0.272`},{501.`,0.003777173`,0.3384021`,0.2588171`},{502.`,0.00294532`,0.3546858`,0.2464838`},{503.`,0.00242488`,0.3716986`,0.2347718`},{504.`,0.002236293`,0.3892875`,0.2234533`},{505.`,0.0024`,0.4073`,0.2123`},{506.`,0.00292552`,0.4256299`,0.2011692`},{507.`,0.00383656`,0.444309`,0.1901196`},{508.`,0.00517484`,0.4633944`,0.1792254`},{509.`,0.00698208`,0.4829395`,0.1685608`},{510.`,0.0093`,0.503`,0.1582`},{511.`,0.01214949`,0.5235693`,0.1481383`},{512.`,0.01553588`,0.544512`,0.1383758`},{513.`,0.01947752`,0.56569`,0.1289942`},{514.`,0.02399277`,0.5869653`,0.1200751`},{515.`,0.0291`,0.6082`,0.1117`},{516.`,0.03481485`,0.6293456`,0.1039048`},{517.`,0.04112016`,0.6503068`,0.09666748`},{518.`,0.04798504`,0.6708752`,0.08998272`},{519.`,0.05537861`,0.6908424`,0.08384531`},{520.`,0.06327`,0.71`,0.07824999`},{521.`,0.07163501`,0.7281852`,0.07320899`},{522.`,0.08046224`,0.7454636`,0.06867816`},{523.`,0.08973996`,0.7619694`,0.06456784`},{524.`,0.09945645`,0.7778368`,0.06078835`},{525.`,0.1096`,0.7932`,0.05725001`},{526.`,0.1201674`,0.8081104`,0.05390435`},{527.`,0.1311145`,0.8224962`,0.05074664`},{528.`,0.1423679`,0.8363068`,0.04775276`},{529.`,0.1538542`,0.8494916`,0.04489859`},{530.`,0.1655`,0.862`,0.04216`},{531.`,0.1772571`,0.8737108`,0.03950728`},{532.`,0.18914`,0.8849624`,0.03693564`},{533.`,0.2011694`,0.8954936`,0.03445836`},{534.`,0.2133658`,0.9054432`,0.03208872`},{535.`,0.2257499`,0.9148501`,0.02984`},{536.`,0.2383209`,0.9237348`,0.02771181`},{537.`,0.2510668`,0.9320924`,0.02569444`},{538.`,0.2639922`,0.9399226`,0.02378716`},{539.`,0.2771017`,0.9472252`,0.02198925`},{540.`,0.2904`,0.954`,0.0203`},{541.`,0.3038912`,0.9602561`,0.01871805`},{542.`,0.3175726`,0.9660074`,0.01724036`},{543.`,0.3314384`,0.9712606`,0.01586364`},{544.`,0.3454828`,0.97600225`,0.01458461`},{545.`,0.3597`,0.9803`,0.0134`},{546.`,0.3740839`,0.9840924`,0.01230723`},{547.`,0.3886396`,0.9874182`,0.01130188`},{548.`,0.4033784`,0.9903128`,0.01037792`},{549.`,0.4183115`,0.9928116`,0.009529306`},{550.`,0.4334499`,0.9949501`,0.008749999`},{551.`,0.4487953`,0.9967108`,0.0080352`},{552.`,0.464336`,0.9980983`,0.0073816`},{553.`,0.480064`,0.999112`,0.0067854`},{554.`,0.4959713`,0.9997482`,0.0062428`},{555.`,0.5120501`,1.`,0.005749999`},{556.`,0.5282959`,0.9998567`,0.0053036`},{557.`,0.5446916`,0.9993046`,0.0048998`},{558.`,0.5612094`,0.9983255`,0.0045342`},{559.`,0.5778215`,0.9968987`,0.0042024`},{560.`,0.5945`,0.995`,0.0039`},{561.`,0.6112209`,0.9926005`,0.003632`},{562.`,0.6279758`,0.9897426`,0.0031414`},{563.`,0.6447602`,0.9864444`,0.0029348`},{564.`,0.6615697`,0.9827241`,0.0029348`},{565.`,0.6784`,0.9876`,0.00274999`},{566.`,0.6953292`,0.9740837`,0.0025852`},{567.`,0.7120586`,0.9691712`,0.0024386`},{568.`,0.7288284`,0.9638568`,0.0023094`},{569.`,0.7455188`,0.9581349`,0.0021968`},{570.`,0.7621`,0.952`,0.0021`},{571.`,0.7785432`,0.9454504`,0.002017733`},{572.`,0.794856`,0.9384992`,0.0019482`},{573.`,0.8109264`,0.9311628`,0.0018898`},{574.`,0.8268248`,0.9234576`,0.001840933`},{575.`,0.8425`,0.9154`,0.0018`},{576.`,0.8579325`,0.9070064`,0.001766267`},{577.`,0.8730816`,0.8982772`,0.0017378`},{578.`,0.8878944`,0.8892048`,0.0017112`},{579.`,0.9023181`,0.8797816`,0.001683067`},{580.`,0.9163`,0.87`,0.001650001`},{581.`,0.9297995`,0.8598613`,0.001610133`},{582.`,0.9427894`,0.849392`,0.0015644`},{583.`,0.9552776`,0.838622`,0.0015136`},{584.`,0.9672179`,0.8275813`,0.001458533`},{585.`,0.9786`,0.8163`,0.0014`},{586.`,0.9893856`,0.8047947`,0.001336667`},{587.`,0.9995488`,0.793082`,0.00127`},{588.`,1.0090892`,0.781192`,0.001205`},{589.`,1.0180064`,0.7691547`,0.001146667`},{590.`,1.0263`,0.757`,0.0011`},{591.`,1.0339827`,0.7447541`,0.0010688`},{592.`,1.040986`,0.7324224`,0.0010494`},{593.`,1.047188`,0.7200036`,0.0010356`},{594.`,1.0524667`,0.7074965`,0.001212`},{595.`,1.0567`,0.6949`,0.001`},{596.`,1.0597944`,0.6822192`,0.00096864`},{597.`,1.0617992`,0.6694716`,0.00092992`},{598.`,1.0628068`,0.6566744`,0.00088688`},{599.`,1.0629096`,0.6438448`,0.00084256`},{600.`,1.0622`,0.631`,0.0008`},{601.`,1.0607352`,0.6181555`,0.00076096`},{602.`,1.0584436`,0.6053144`,0.00073268`},{603.`,1.0552244`,0.5924756`,0.00068592`},{604.`,1.0509768`,0.5796379`,0.00064544`},{605.`,1.0456`,0.5668`,0.0006`},{606.`,1.0390369`,0.5539611`,0.000547867`},{607.`,1.0313608`,0.5411372`,0.0004916`},{608.`,1.0226662`,0.5283528`,0.0004354`},{609.`,1.0130477`,0.5156323`,0.000383467`},{610.`,1.0026`,0.503`,0.00034`},{611.`,0.9913675`,0.4904688`,0.000307253`},{612.`,0.9793314`,0.4780304`,0.00028316`},{613.`,0.9664916`,0.4656776`,0.00026544`},{614.`,0.9528479`,0.4534032`,0.000251813`},{615.`,0.9384`,0.4412`,0.00024`},{616.`,0.923194`,0.42908`,0.000229547`},{617.`,0.907244`,0.417036`,0.00022064`},{618.`,0.890502`,0.405032`,0.00021196`},{619.`,0.87292`,0.393032`,0.000202187`},{620.`,0.8544499`,0.381`,0.00019`},{621.`,0.835084`,0.3689184`,0.000174213`},{622.`,0.814946`,0.3568274`,0.00015564`},{623.`,0.794186`,0.3447768`,0.00013596`},{624.`,0.772954`,0.3328176`,0.000116853`},{625.`,0.7514`,0.321`,0.0001`},{626.`,0.7295836`,0.3093381`,0.0000861333`},{627.`,0.7075888`,0.2978504`,0.0000746`},{628.`,0.6856022`,0.2865936`,0.000065`},{629.`,0.6638104`,0.2756245`,0.0000569333`},{630.`,0.6424`,0.265`,0.00005`},{631.`,0.6215149`,0.2547632`,0.00004416`},{632.`,0.6011138`,0.2448896`,0.00003948`},{633.`,0.5811052`,0.2353344`,0.00003572`},{634.`,0.5613977`,0.2260528`,0.00003264`},{635.`,0.5419`,0.217`,0.00003`},{636.`,0.5225995`,0.2081616`,0.0000276533`},{637.`,0.5035464`,0.1995488`,0.00002556`},{638.`,0.4847436`,0.1911552`,0.00002364`},{639.`,0.4661939`,0.1829744`,0.0000218133`},{640.`,0.4479`,0.175`,0.00002`},{641.`,0.4298613`,0.1672235`,0.0000181333`},{642.`,0.412098`,0.1596464`,0.0000162`},{643.`,0.394644`,0.1522776`,0.0000142`},{644.`,0.3775333`,0.1451259`,0.0000121333`},{645.`,0.3608`,0.1382`,0.00001`},{646.`,0.3444563`,0.1315003`,7.73333`*^-6},{647.`,0.3285168`,0.1250248`,5.4`*^-6},{648.`,0.3130192`,0.1187792`,3.2`*^-6},{649.`,0.2980011`,0.1127691`,1.33333`*^-6},{650.`,0.2835`,0.107`,0.`},{651.`,0.2695448`,0.1014762`,0.`},{652.`,0.2561184`,0.09618864`,0.`},{653.`,0.2431896`,0.09112296`,0.`},{654.`,0.2307272`,0.08626485`,0.`},{655.`,0.2187`,0.0816`,0.`},{656.`,0.2070971`,0.07712064`,0.`},{657.`,0.1959232`,0.07382552`,0.`},{658.`,0.1851708`,0.06871008`,0.`},{659.`,0.1748323`,0.06476976`,0.`},{660.`,0.1649`,0.061`,0.`},{661.`,0.1553667`,0.05739621`,0.`},{662.`,0.14623`,0.05395504`,0.`},{663.`,0.13749`,0.05067376`,0.`},{664.`,0.1291467`,0.04754965`,0.`},{665.`,0.1212`,0.04458`,0.`},{666.`,0.1136397`,0.04175872`,0.`},{667.`,0.106465`,0.03908496`,0.`},{668.`,0.099333061`,0.03656384`,0.`},{669.`,0.09333061`,0.03420048`,0.`},{670.`,0.0874`,0.032`,0.`},{671.`,0.08190096`,0.02996261`,0.`},{672.`,0.07680428`,0.02807664`,0.`},{673.`,0.07207712`,0.02632936`,0.`},{674.`,0.06768664`,0.02470805`,0.`},{675.`,0.0636`,0.0232`,0.`},{676.`,0.05980685`,0.02180077`,0.`},{677.`,0.05628216`,0.02050112`,0.`},{678.`,0.05297104`,0.01928108`,0.`},{679.`,0.04981861`,0.01812069`,0.`},{680.`,0.04677`,0.017`,0.`},{681.`,0.04378405`,0.01590379`,0.`},{682.`,0.04087536`,0.01483718`,0.`},{683.`,0.03807264`,0.01381068`,0.`},{684.`,0.03540461`,0.01283478`,0.`},{685.`,0.0329`,0.01192`,0.`},{686.`,0.03056419`,0.01106831`,0.`},{687.`,0.02838056`,0.01027339`,0.`},{688.`,0.02634484`,0.009533311`,0.`},{689.`,0.02445275`,0.008846157`,0.`},{690.`,0.0227`,0.00821`,0.`},{691.`,0.02108429`,0.007623781`,0.`},{692.`,0.01959988`,0.007085424`,0.`},{693.`,0.01823732`,0.006591476`,0.`},{694.`,0.01698717`,0.006138485`,0.`},{695.`,0.01584`,0.005723`,0.`},{696.`,0.01479064`,0.005343059`,0.`},{697.`,0.01383132`,0.004995796`,0.`},{698.`,0.01294868`,0.004676404`,0.`},{699.`,0.0121292`,0.004380075`,0.`},{700.`,0.01135916`,0.004102`,0.`},{701.`,0.01062935`,0.003838453`,0.`},{702.`,0.009938846`,0.003589099`,0.`},{703.`,0.009288422`,0.003354219`,0.`},{704.`,0.008678854`,0.003134093`,0.`},{705.`,0.008110916`,0.002929`,0.`},{706.`,0.007582388`,0.002738139`,0.`},{707.`,0.007088746`,0.002559876`,0.`},{708.`,0.006627313`,0.002393244`,0.`},{709.`,0.006195408`,0.002237275`,0.`},{710.`,0.005790346`,0.002091`,0.`},{711.`,0.005409826`,0.001953587`,0.`},{712.`,0.005052583`,0.00182458`,0.`},{713.`,0.004717512`,0.00170358`,0.`},{714.`,0.004403507`,0.001590187`,0.`},{715.`,0.004109457`,0.001484`,0.`},{716.`,0.003833913`,0.001384496`,0.`},{717.`,0.003575748`,0.001291268`,0.`},{718.`,0.003334342`,0.001204092`,0.`},{719.`,0.003109075`,0.001122744`,0.`},{720.`,0.002899327`,0.001047`,0.`},{721.`,0.002704348`,0.00097659`,0.`},{722.`,0.00252302`,0.000911109`,0.`},{723.`,0.002354168`,0.000850133`,0.`},{724.`,0.002196616`,0.000793238`,0.`},{725.`,0.00204919`,0.00074`,0.`},{726.`,0.00191096`,0.000690083`,0.`},{727.`,0.001781438`,0.00064331`,0.`},{728.`,0.00166011`,0.000599496`,0.`},{729.`,0.001546459`,0.000558455`,0.`},{730.`,0.001439971`,0.00052`,0.`},{735.`,0.001`,0.000361`,0.`},{740.`,0.00069`,0.000249`,0.`},{745.`,0.000476`,0.000172`,0.`},{750.`,0.000332`,0.00012`,0.`},{755.`,0.000235`,0.000085`,0.`},{760.`,0.000166`,0.00006`,0.`},{765.`,0.000117`,0.000042`,0.`},{770.`,0.000083`,0.00003`,0.`},{775.`,0.000059`,0.000021`,0.`},{780.`,0.000042`,0.000015`,0.`}};
$ExcitationInterpolation=Interpolation[Thread[{$ExcitationRaw[[;;,1]],$ExcitationRaw[[;;,{2,3,4}]]}]];


SetAttributes[SpectrumExcitation,Listable];
SpectrumExcitation[wvl_?NumericQ]:=If[wvl<380||wvl>780,{0.,0.,0.},$ExcitationInterpolation[wvl]];


SetAttributes[SpectrumColor,Listable];
SpectrumColor[wvl_?NumericQ]:=XYZColor@@SpectrumExcitation[wvl];


(* ::Text:: *)
(*RGB color of a blackbody at different temperature. Based on D65 intensity profile. *)
(*reference: http://www.vendian.org/mncharity/dir3/blackbody/UnstableURLs/bbr_color.html*)


$TempRGBRaw=N@{#1,#2/255,#3/255,#4/255}&@@@{{741,255,0,0},{800,255,13,0},{900,255,34,0},{1000,255,51,0},{1100,255,69,0},{1200,255,82,0},{1300,255,93,0},{1400,255,102,0},{1500,255,111,0},{1600,255,118,0},{1700,255,124,0},{1800,255,130,0},{1900,255,135,0},{2000,255,141,11},{2100,255,146,29},{2200,255,152,41},{2300,255,157,51},{2400,255,162,60},{2500,255,166,69},{2600,255,170,77},{2700,255,174,84},{2800,255,178,91},{2900,255,182,98},{3000,255,185,105},{3100,255,189,111},{3200,255,192,118},{3300,255,195,124},{3400,255,198,130},{3500,255,201,135},{3600,255,203,141},{3700,255,206,146},{3800,255,208,151},{3900,255,211,156},{4000,255,213,161},{4100,255,215,166},{4200,255,217,171},{4300,255,219,175},{4400,255,221,180},{4500,255,223,184},{4600,255,225,188},{4700,255,226,192},{4800,255,228,196},{4900,255,229,200},{5000,255,231,204},{5100,255,232,208},{5200,255,234,211},{5300,255,235,215},{5400,255,237,218},{5500,255,238,222},{5600,255,239,225},{5700,255,240,228},{5800,255,241,231},{5900,255,243,234},{6000,255,244,237},{6100,255,245,240},{6200,255,246,243},{6300,255,247,245},{6400,255,248,248},{6500,255,249,251},{6600,255,249,253},{6700,254,250,255},{6800,252,248,255},{6900,250,247,255},{7000,247,245,255},{7100,245,244,255},{7200,243,243,255},{7300,241,241,255},{7400,239,240,255},{7500,238,239,255},{7600,236,238,255},{7700,234,237,255},{7800,233,236,255},{7900,231,234,255},{8000,229,233,255},{8100,228,233,255},{8200,227,232,255},{8300,225,231,255},{8400,224,230,255},{8500,223,229,255},{8600,221,228,255},{8700,220,227,255},{8800,219,226,255},{8900,218,226,255},{9000,217,225,255},{9100,216,224,255},{9200,215,223,255},{9300,214,223,255},{9400,213,222,255},{9500,212,221,255},{9600,211,221,255},{9700,210,220,255},{9800,209,220,255},{9900,208,219,255},{10000,207,218,255},{10100,207,218,255},{10200,206,217,255},{10300,205,217,255},{10400,204,216,255},{10500,204,216,255},{10600,203,215,255},{10700,202,215,255},{10800,202,214,255},{10900,201,214,255},{11000,200,213,255},{11100,200,213,255},{11200,199,212,255},{11300,198,212,255},{11400,198,212,255},{11500,197,211,255},{11600,197,211,255},{11700,196,210,255},{11800,196,210,255},{11900,195,210,255},{12000,195,209,255},{12100,194,209,255},{12200,194,208,255},{12300,193,208,255},{12400,193,208,255},{12500,192,207,255},{12600,192,207,255},{12700,191,207,255},{12800,191,206,255},{12900,190,206,255},{13000,190,206,255},{13100,190,206,255},{13200,189,205,255},{13300,189,205,255},{13400,188,205,255},{13500,188,204,255},{13600,188,204,255},{13700,187,204,255},{13800,187,204,255},{13900,187,203,255},{14000,186,203,255},{14100,186,203,255},{14200,186,203,255},{14300,185,202,255},{14400,185,202,255},{14500,185,202,255},{14600,184,202,255},{14700,184,201,255},{14800,184,201,255},{14900,184,201,255},{15000,183,201,255},{15100,183,201,255},{15200,183,200,255},{15300,182,200,255},{15400,182,200,255},{15500,182,200,255},{15600,182,200,255},{15700,181,199,255},{15800,181,199,255},{15900,181,199,255},{16000,181,199,255},{16100,180,199,255},{16200,180,198,255},{16300,180,198,255},{16400,180,198,255},{16500,179,198,255},{16600,179,198,255},{16700,179,198,255},{16800,179,197,255},{16900,179,197,255},{17000,178,197,255},{17100,178,197,255},{17200,178,197,255},{17300,178,197,255},{17400,178,196,255},{17500,177,196,255},{17600,177,196,255},{17700,177,196,255},{17800,177,196,255},{17900,177,196,255},{18000,176,196,255},{18100,176,195,255},{18200,176,195,255},{18300,176,195,255},{18400,176,195,255},{18500,176,195,255},{18600,175,195,255},{18700,175,195,255},{18800,175,194,255},{18900,175,194,255},{19000,175,194,255},{19100,175,194,255},{19200,174,194,255},{19300,174,194,255},{19400,174,194,255},{19500,174,194,255},{19600,174,194,255},{19700,174,193,255},{19800,174,193,255},{19900,173,193,255},{20000,173,193,255},{20100,173,193,255},{20200,173,193,255},{20300,173,193,255},{20400,173,193,255},{20500,173,193,255},{20600,173,192,255},{20700,172,192,255},{20800,172,192,255},{20900,172,192,255},{21000,172,192,255},{21100,172,192,255},{21200,172,192,255},{21300,172,192,255},{21400,172,192,255},{21500,171,192,255},{21600,171,192,255},{21700,171,191,255},{21800,171,191,255},{21900,171,191,255},{22000,171,191,255},{22100,171,191,255},{22200,171,191,255},{22300,171,191,255},{22400,170,191,255},{22500,170,191,255},{22600,170,191,255},{22700,170,191,255},{22800,170,190,255},{22900,170,190,255},{23000,170,190,255},{23100,170,190,255},{23200,170,190,255},{23300,170,190,255},{23400,169,190,255},{23500,169,190,255},{23600,169,190,255},{23700,169,190,255},{23800,169,190,255},{23900,169,190,255},{24000,169,190,255},{24100,169,190,255},{24200,169,189,255},{24300,169,189,255},{24400,169,189,255},{24500,168,189,255},{24600,168,189,255},{24700,168,189,255},{24800,168,189,255},{24900,168,189,255},{25000,168,189,255},{25100,168,189,255},{25200,168,189,255},{25300,168,189,255},{25400,168,189,255},{25500,168,189,255},{25600,168,189,255},{25700,167,188,255},{25800,167,188,255},{25900,167,188,255},{26000,167,188,255},{26100,167,188,255},{26200,167,188,255},{26300,167,188,255},{26400,167,188,255},{26500,167,188,255},{26600,167,188,255},{26700,167,188,255},{26800,167,188,255},{26900,167,188,255},{27000,167,188,255},{27100,166,188,255},{27200,166,188,255},{27300,166,188,255},{27400,166,187,255},{27500,166,187,255},{27600,166,187,255},{27700,166,187,255},{27800,166,187,255},{27900,166,187,255},{28000,166,187,255},{28100,166,187,255},{28200,166,187,255},{28300,166,187,255},{28400,166,187,255},{28500,166,187,255},{28600,166,187,255},{28700,165,187,255},{28800,165,187,255},{28900,165,187,255},{29000,165,187,255},{29100,165,187,255},{29200,165,187,255},{29300,165,187,255},{29400,165,187,255},{29500,165,186,255},{29600,165,186,255},{29700,165,186,255},{29800,165,186,255},{29900,165,186,255},{30000,165,186,255},{30100,165,186,255},{30200,165,186,255},{30300,165,186,255},{30400,165,186,255},{30500,165,186,255},{30600,164,186,255},{30700,164,186,255},{30800,164,186,255},{30900,164,186,255},{31000,164,186,255},{31100,164,186,255},{31200,164,186,255},{31300,164,186,255},{31400,164,186,255},{31500,164,186,255},{31600,164,186,255},{31700,164,186,255},{31800,164,186,255},{31900,164,186,255},{32000,164,185,255},{32100,164,185,255},{32200,164,185,255},{32300,164,185,255},{32400,164,185,255},{32500,164,185,255},{32600,164,185,255},{32700,163,185,255},{32800,163,185,255},{32900,163,185,255},{33000,163,185,255},{33100,163,185,255},{33200,163,185,255},{33300,163,185,255},{33400,163,185,255},{33500,163,185,255},{33600,163,185,255},{33700,163,185,255},{33800,163,185,255},{33900,163,185,255},{34000,163,185,255},{34100,163,185,255},{34200,163,185,255},{34300,163,185,255},{34400,163,185,255},{34500,163,185,255},{34600,163,185,255},{34700,163,185,255},{34800,163,185,255},{34900,163,185,255},{35000,163,184,255},{35100,163,184,255},{35200,162,184,255},{35300,162,184,255},{35400,162,184,255},{35500,162,184,255},{35600,162,184,255},{35700,162,184,255},{35800,162,184,255},{35900,162,184,255},{36000,162,184,255},{36100,162,184,255},{36200,162,184,255},{36300,162,184,255},{36400,162,184,255},{36500,162,184,255},{36600,162,184,255},{36700,162,184,255},{36800,162,184,255},{36900,162,184,255},{37000,162,184,255},{37100,162,184,255},{37200,162,184,255},{37300,162,184,255},{37400,162,184,255},{37500,162,184,255},{37600,162,184,255},{37700,162,184,255},{37800,162,184,255},{37900,162,184,255},{38000,162,184,255},{38100,162,184,255},{38200,162,184,255},{38300,161,184,255},{38400,161,184,255},{38500,161,184,255},{38600,161,183,255},{38700,161,183,255},{38800,161,183,255},{38900,161,183,255},{39000,161,183,255},{39100,161,183,255},{39200,161,183,255},{39300,161,183,255},{39400,161,183,255},{39500,161,183,255},{39600,161,183,255},{39700,161,183,255},{39800,161,183,255},{39900,161,183,255},{40000,161,183,255}};
$TempRGBInterpolation=Interpolation[Thread[{$TempRGBRaw[[;;,1]],$TempRGBRaw[[;;,{2,3,4}]]}]];


SetAttributes[TemperatureColor,Listable];
TemperatureColor[temp_?NumericQ]:=If[temp<741,RGBColor[1.,0.,0.],If[temp>40000,RGBColor[0.63137`,0.71765`,1.],RGBColor@@$TempRGBInterpolation[temp]]];


$TempIntensityRaw={{1000,2.472`*^6},{1100,2.112`*^7},{1200,1.282`*^8},{1300,5.959`*^8},{1400,2.243`*^9},{1500,7.121`*^9},{1600,1.967`*^10},{1700,4.839`*^10},{1800,1.081`*^11},{1900,2.224`*^11},{2000,4.268`*^11},{2100,7.71`*^11},{2200,1.322`*^12},{2300,2.166`*^12},{2400,3.408`*^12},{2500,5.178`*^12},{2600,7.624`*^12},{2700,1.092`*^13},{2800,1.524`*^13},{2900,2.081`*^13},{3000,2.784`*^13},{3100,3.657`*^13},{3200,4.725`*^13},{3300,6.012`*^13},{3400,7.545`*^13},{3500,9.349`*^13},{3600,1.145`*^14},{3700,1.387`*^14},{3800,1.665`*^14},{3900,1.979`*^14},{4000,2.333`*^14},{4100,2.729`*^14},{4200,3.169`*^14},{4300,3.654`*^14},{4400,4.188`*^14},{4500,4.771`*^14},{4600,5.406`*^14},{4700,6.093`*^14},{4800,6.835`*^14},{4900,7.632`*^14},{5000,8.485`*^14},{5100,9.396`*^14},{5200,1.036`*^15},{5300,1.139`*^15},{5400,1.248`*^15},{5500,1.363`*^15},{5600,1.484`*^15},{5700,1.611`*^15},{5800,1.744`*^15},{5900,1.883`*^15},{6000,2.028`*^15},{6100,2.179`*^15},{6200,2.337`*^15},{6300,2.5`*^15},{6400,2.669`*^15},{6500,2.845`*^15},{6600,3.026`*^15},{6700,3.214`*^15},{6800,3.407`*^15},{6900,3.606`*^15},{7000,3.811`*^15},{7100,4.022`*^15},{7200,4.238`*^15},{7300,4.46`*^15},{7400,4.688`*^15},{7500,4.92`*^15},{7600,5.159`*^15},{7700,5.402`*^15},{7800,5.651`*^15},{7900,5.906`*^15},{8000,6.165`*^15},{8100,6.429`*^15},{8200,6.698`*^15},{8300,6.973`*^15},{8400,7.252`*^15},{8500,7.535`*^15},{8600,7.824`*^15},{8700,8.117`*^15},{8800,8.415`*^15},{8900,8.717`*^15},{9000,9.023`*^15},{9100,9.334`*^15},{9200,9.649`*^15},{9300,9.969`*^15},{9400,1.029`*^16},{9500,1.062`*^16},{9600,1.095`*^16},{9700,1.129`*^16},{9800,1.163`*^16},{9900,1.197`*^16},{10000,1.231`*^16},{10100,1.267`*^16},{10200,1.302`*^16},{10300,1.338`*^16},{10400,1.374`*^16},{10500,1.41`*^16},{10600,1.447`*^16},{10700,1.484`*^16},{10800,1.521`*^16},{10900,1.559`*^16},{11000,1.597`*^16},{11100,1.636`*^16},{11200,1.674`*^16},{11300,1.713`*^16},{11400,1.752`*^16},{11500,1.792`*^16},{11600,1.832`*^16},{11700,1.872`*^16},{11800,1.912`*^16},{11900,1.953`*^16},{12000,1.994`*^16},{12100,2.035`*^16},{12200,2.076`*^16},{12300,2.118`*^16},{12400,2.16`*^16},{12500,2.202`*^16},{12600,2.244`*^16},{12700,2.287`*^16},{12800,2.33`*^16},{12900,2.373`*^16},{13000,2.416`*^16},{13100,2.459`*^16},{13200,2.503`*^16},{13300,2.547`*^16},{13400,2.591`*^16},{13500,2.635`*^16},{13600,2.68`*^16},{13700,2.724`*^16},{13800,2.769`*^16},{13900,2.814`*^16},{14000,2.86`*^16},{14100,2.905`*^16},{14200,2.951`*^16},{14300,2.997`*^16},{14400,3.043`*^16},{14500,3.089`*^16},{14600,3.135`*^16},{14700,3.182`*^16},{14800,3.228`*^16},{14900,3.275`*^16},{15000,3.322`*^16},{15100,3.369`*^16},{15200,3.416`*^16},{15300,3.464`*^16},{15400,3.511`*^16},{15500,3.559`*^16},{15600,3.607`*^16},{15700,3.655`*^16},{15800,3.703`*^16},{15900,3.751`*^16},{16000,3.8`*^16},{16100,3.848`*^16},{16200,3.897`*^16},{16300,3.946`*^16},{16400,3.995`*^16},{16500,4.044`*^16},{16600,4.093`*^16},{16700,4.143`*^16},{16800,4.192`*^16},{16900,4.241`*^16},{17000,4.291`*^16},{17100,4.341`*^16},{17200,4.391`*^16},{17300,4.441`*^16},{17400,4.491`*^16},{17500,4.541`*^16},{17600,4.592`*^16},{17700,4.642`*^16},{17800,4.693`*^16},{17900,4.743`*^16},{18000,4.794`*^16},{18100,4.845`*^16},{18200,4.896`*^16},{18300,4.947`*^16},{18400,4.998`*^16},{18500,5.049`*^16},{18600,5.1`*^16},{18700,5.152`*^16},{18800,5.203`*^16},{18900,5.255`*^16},{19000,5.307`*^16},{19100,5.358`*^16},{19200,5.41`*^16},{19300,5.462`*^16},{19400,5.514`*^16},{19500,5.566`*^16},{19600,5.618`*^16},{19700,5.671`*^16},{19800,5.723`*^16},{19900,5.775`*^16},{20000,5.828`*^16},{20100,5.88`*^16},{20200,5.933`*^16},{20300,5.986`*^16},{20400,6.038`*^16},{20500,6.091`*^16},{20600,6.144`*^16},{20700,6.197`*^16},{20800,6.25`*^16},{20900,6.303`*^16},{21000,6.357`*^16},{21100,6.41`*^16},{21200,6.463`*^16},{21300,6.517`*^16},{21400,6.57`*^16},{21500,6.623`*^16},{21600,6.677`*^16},{21700,6.731`*^16},{21800,6.784`*^16},{21900,6.838`*^16},{22000,6.892`*^16},{22100,6.946`*^16},{22200,7.`*^16},{22300,7.054`*^16},{22400,7.108`*^16},{22500,7.162`*^16},{22600,7.216`*^16},{22700,7.27`*^16},{22800,7.325`*^16},{22900,7.379`*^16},{23000,7.433`*^16},{23100,7.488`*^16},{23200,7.542`*^16},{23300,7.597`*^16},{23400,7.651`*^16},{23500,7.706`*^16},{23600,7.76`*^16},{23700,7.815`*^16},{23800,7.87`*^16},{23900,7.925`*^16},{24000,7.98`*^16},{24100,8.035`*^16},{24200,8.089`*^16},{24300,8.144`*^16},{24400,8.199`*^16},{24500,8.255`*^16},{24600,8.31`*^16},{24700,8.365`*^16},{24800,8.42`*^16},{24900,8.475`*^16},{25000,8.531`*^16},{25100,8.586`*^16},{25200,8.641`*^16},{25300,8.697`*^16},{25400,8.752`*^16},{25500,8.808`*^16},{25600,8.863`*^16},{25700,8.919`*^16},{25800,8.974`*^16},{25900,9.03`*^16},{26000,9.086`*^16},{26100,9.141`*^16},{26200,9.197`*^16},{26300,9.253`*^16},{26400,9.309`*^16},{26500,9.365`*^16},{26600,9.421`*^16},{26700,9.476`*^16},{26800,9.532`*^16},{26900,9.588`*^16},{27000,9.644`*^16},{27100,9.701`*^16},{27200,9.757`*^16},{27300,9.813`*^16},{27400,9.869`*^16},{27500,9.925`*^16},{27600,9.981`*^16},{27700,1.004`*^17},{27800,1.009`*^17},{27900,1.015`*^17},{28000,1.021`*^17},{28100,1.026`*^17},{28200,1.032`*^17},{28300,1.038`*^17},{28400,1.043`*^17},{28500,1.049`*^17},{28600,1.055`*^17},{28700,1.06`*^17},{28800,1.066`*^17},{28900,1.072`*^17},{29000,1.077`*^17},{29100,1.083`*^17},{29200,1.089`*^17},{29300,1.094`*^17},{29400,1.1`*^17},{29500,1.106`*^17},{29600,1.111`*^17},{29700,1.117`*^17},{29800,1.123`*^17},{29900,1.128`*^17},{30000,1.134`*^17},{30100,1.14`*^17},{30200,1.145`*^17},{30300,1.151`*^17},{30400,1.157`*^17},{30500,1.162`*^17},{30600,1.168`*^17},{30700,1.174`*^17},{30800,1.18`*^17},{30900,1.185`*^17},{31000,1.191`*^17},{31100,1.197`*^17},{31200,1.202`*^17},{31300,1.208`*^17},{31400,1.214`*^17},{31500,1.22`*^17},{31600,1.225`*^17},{31700,1.231`*^17},{31800,1.237`*^17},{31900,1.242`*^17},{32000,1.248`*^17},{32100,1.254`*^17},{32200,1.26`*^17},{32300,1.265`*^17},{32400,1.271`*^17},{32500,1.277`*^17},{32600,1.283`*^17},{32700,1.288`*^17},{32800,1.294`*^17},{32900,1.3`*^17},{33000,1.306`*^17},{33100,1.311`*^17},{33200,1.317`*^17},{33300,1.323`*^17},{33400,1.329`*^17},{33500,1.334`*^17},{33600,1.34`*^17},{33700,1.346`*^17},{33800,1.352`*^17},{33900,1.358`*^17},{34000,1.363`*^17},{34100,1.369`*^17},{34200,1.375`*^17},{34300,1.381`*^17},{34400,1.386`*^17},{34500,1.392`*^17},{34600,1.398`*^17},{34700,1.404`*^17},{34800,1.41`*^17},{34900,1.415`*^17},{35000,1.421`*^17},{35100,1.427`*^17},{35200,1.433`*^17},{35300,1.439`*^17},{35400,1.444`*^17},{35500,1.45`*^17},{35600,1.456`*^17},{35700,1.462`*^17},{35800,1.468`*^17},{35900,1.473`*^17},{36000,1.479`*^17},{36100,1.485`*^17},{36200,1.491`*^17},{36300,1.497`*^17},{36400,1.502`*^17},{36500,1.508`*^17},{36600,1.514`*^17},{36700,1.52`*^17},{36800,1.526`*^17},{36900,1.531`*^17},{37000,1.537`*^17},{37100,1.543`*^17},{37200,1.549`*^17},{37300,1.555`*^17},{37400,1.561`*^17},{37500,1.566`*^17},{37600,1.572`*^17},{37700,1.578`*^17},{37800,1.584`*^17},{37900,1.59`*^17},{38000,1.595`*^17},{38100,1.601`*^17},{38200,1.607`*^17},{38300,1.613`*^17},{38400,1.619`*^17},{38500,1.625`*^17},{38600,1.63`*^17},{38700,1.636`*^17},{38800,1.642`*^17},{38900,1.648`*^17},{39000,1.654`*^17},{39100,1.66`*^17},{39200,1.666`*^17},{39300,1.671`*^17},{39400,1.677`*^17},{39500,1.683`*^17},{39600,1.689`*^17},{39700,1.695`*^17},{39800,1.701`*^17},{39900,1.707`*^17},{40000,1.712`*^17}};
$TempIntensityInterpolation=Interpolation[$TempIntensityRaw];


SetAttributes[TemperatureIntensity,Listable];
TemperatureIntensity[temp_?NumericQ]:=If[temp<1000,1.8860774641476645`*^13 temp Exp[-22755.32264696182`/temp],If[temp>40000,\!\(\*
TagBox[
RowBox[{
RowBox[{"-", "6.17373349339735`*^16"}], "+", 
RowBox[{"5.823433373349338`*^12", " ", "temp"}]}],
Short[#, 2]& ]\),$TempIntensityRaw[temp]]];


End[];
EndPackage[];
